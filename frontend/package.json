{
  "name": "codag",
  "displayName": "Codag",
  "description": "Visualize AI/LLM workflows in your codebase",
  "version": "0.1.0",
  "publisher": "codag",
  "engines": {
    "vscode": "^1.95.0"
  },
  "categories": [
    "Visualization",
    "Other"
  ],
  "activationEvents": [],
  "main": "./out/extension.js",
  "contributes": {
    "commands": [
      {
        "command": "codag.open",
        "title": "Codag: Open"
      }
    ],
    "configuration": {
      "title": "Codag",
      "properties": {
        "codag.apiUrl": {
          "type": "string",
          "default": "http://localhost:8000",
          "description": "Backend API URL"
        }
      }
    },
    "chatParticipants": [
      {
        "id": "codag.workflow",
        "name": "codag",
        "fullName": "Codag",
        "description": "Expert in LLM workflow architecture, node relationships, and code generation for workflow modifications",
        "isSticky": true,
        "icon": "media/icon-chat.png",
        "disambiguation": [
          {
            "category": "workflow_architecture",
            "description": "Questions about LLM workflow nodes, edges, architecture, or modifying workflow steps",
            "examples": [
              "How do I add a node between X and Y?",
              "What nodes come after the LLM call?",
              "Explain the critical path in this workflow",
              "Show me the cross-file dependencies",
              "Add validation before this step",
              "What's the workflow structure?"
            ]
          }
        ]
      }
    ],
    "languageModelTools": [
      {
        "name": "workflow-context",
        "displayName": "Workflow Context",
        "modelDescription": "ALWAYS USE THIS TOOL when the user mentions: workflow, graph, node, edge, visualization, diagram, flow, pipeline, LLM architecture, agent, chain, DAG, critical path, entry point, exit point, trigger, tool call, decision, integration, memory, parser, or any AI/ML workflow concept. This tool provides the complete workflow graph context including all nodes, their connections, source file locations, and workflow structure. Auto-detects the active file and selected node. Use this as the primary context source for ANY workflow-related question or task.",
        "inputSchema": {
          "type": "object",
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Optional: Path to the file. Auto-detects from active editor if not provided."
            },
            "operation": {
              "type": "string",
              "description": "Optional: Type of operation being performed (e.g., 'insert_node', 'modify_workflow')."
            }
          },
          "required": []
        }
      },
      {
        "name": "workflow-file-reader",
        "displayName": "Workflow File Reader",
        "modelDescription": "Reads source code from workflow node locations. USE THIS when you need to see implementation code, modify workflow steps, add functionality, understand node behavior, or examine any file referenced in the workflow graph. Works with any file path or source location from workflow-context.",
        "inputSchema": {
          "type": "object",
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the file to read"
            },
            "lineStart": {
              "type": "number",
              "description": "Optional: Starting line number (1-indexed)"
            },
            "lineEnd": {
              "type": "number",
              "description": "Optional: Ending line number (1-indexed)"
            }
          },
          "required": ["filePath"]
        }
      },
      {
        "name": "workflow-query",
        "displayName": "Workflow Query",
        "modelDescription": "Gets all nodes in a specific workflow. USE THIS when user asks about a workflow by name, wants to see workflow steps/structure, or asks 'what does X workflow do'. Returns nodes, entry/exit points, critical path.",
        "inputSchema": {
          "type": "object",
          "properties": {
            "workflowName": {
              "type": "string",
              "description": "Name of the workflow to query (case-insensitive partial match)"
            },
            "includeDetails": {
              "type": "boolean",
              "description": "Whether to include detailed node information (source file, location, function). Defaults to false for concise output."
            }
          },
          "required": ["workflowName"]
        }
      },
      {
        "name": "node-query",
        "displayName": "Node Query",
        "modelDescription": "Searches nodes by type, name, or connections. USE THIS when user asks 'find all LLM nodes', 'what tools are available', 'what connects to X', or any node filtering question. Supports filtering by nodeType (trigger/llm/tool/decision/integration/memory/parser/output).",
        "inputSchema": {
          "type": "object",
          "properties": {
            "nodeIds": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Optional: Specific node IDs to query"
            },
            "workflowName": {
              "type": "string",
              "description": "Optional: Filter to nodes in a specific workflow"
            },
            "nodeType": {
              "type": "string",
              "description": "Optional: Filter by node type (trigger/llm/tool/decision/integration/memory/parser/output)"
            },
            "connectedTo": {
              "type": "string",
              "description": "Optional: Filter to nodes connected to this node ID (either before or after)"
            },
            "includeCodeSnippets": {
              "type": "boolean",
              "description": "Optional: Include code context around each node. Defaults to false."
            }
          },
          "required": []
        }
      },
      {
        "name": "workflow-navigate",
        "displayName": "Workflow Navigator",
        "modelDescription": "Traces execution paths between nodes. USE THIS when user asks 'how does data flow from X to Y', 'what depends on X', 'what does X affect', 'path between nodes', or any dependency/impact analysis question. Operations: path (A to B), upstream (what feeds into), downstream (what depends on).",
        "inputSchema": {
          "type": "object",
          "properties": {
            "operation": {
              "type": "string",
              "enum": ["path", "upstream", "downstream"],
              "description": "Type of navigation: 'path' (find path between nodes), 'upstream' (find predecessors), 'downstream' (find successors)"
            },
            "fromNode": {
              "type": "string",
              "description": "Starting node ID (required for all operations)"
            },
            "toNode": {
              "type": "string",
              "description": "Target node ID (required only for 'path' operation)"
            },
            "workflowName": {
              "type": "string",
              "description": "Optional: Filter to specific workflow"
            },
            "maxDepth": {
              "type": "number",
              "description": "Optional: Maximum depth for upstream/downstream searches. Defaults to 5."
            }
          },
          "required": ["operation", "fromNode"]
        }
      }
    ]
  },
  "scripts": {
    "vscode:prepublish": "npm run compile",
    "compile": "tsc -p ./ && npm run compile:webview",
    "compile:extension": "tsc -p ./",
    "compile:webview": "esbuild src/webview-client/main.ts --bundle --outfile=out/webview-client/main.js --format=iife --target=es2020 --sourcemap",
    "watch": "concurrently \"tsc -watch -p ./\" \"npm run watch:webview\"",
    "watch:extension": "tsc -watch -p ./",
    "watch:webview": "esbuild src/webview-client/main.ts --bundle --outfile=out/webview-client/main.js --format=iife --target=es2020 --sourcemap --watch"
  },
  "devDependencies": {
    "@types/dagre": "^0.7.52",
    "@types/node": "^20.0.0",
    "@types/vscode": "^1.95.0",
    "concurrently": "^8.2.0",
    "esbuild": "^0.19.0",
    "typescript": "^5.0.0"
  },
  "dependencies": {
    "@typescript-eslint/typescript-estree": "^6.0.0",
    "acorn": "^8.11.0",
    "acorn-jsx": "^5.3.2",
    "acorn-walk": "^8.3.0",
    "axios": "^1.6.0",
    "dagre": "^0.8.5"
  }
}
